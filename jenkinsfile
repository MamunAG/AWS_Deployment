pipeline {
    agent any
 
    environment {
        registry = '1almamun/aws_docker_example'
        registryCredentialUp = 'docker_up'
        dockerImage = ''
    }

    stages {
        stage('Start') {
            steps {
                echo 'Pipeline start.'
            }
        }
    
        stage('Deploy to Kubernetes') {
            steps {
                script {
                    // Set the kubeconfig path
                    //def kubeconfigPath = "${HOME}/.kube/config"
                    echo "this location= ${HOME}"

                    def kubeconfigPath = "${HOME}/../../../home/ubuntu/.kube/config"

                    // Apply the YAML configuration using kubectl
                    sh "kubectl apply -f k8s/deployment.yaml --kubeconfig=${kubeconfigPath} --namespace=next"
                }
            }
        }
    }
}
